<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>生活仪表盘 | Life Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gray-800 border-b border-gray-700">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-chart-line text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">生活仪表盘</h1>
                        <p class="text-gray-400 text-sm">Life Dashboard</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-2xl font-bold text-blue-400" id="current-date">--</p>
                    <p class="text-gray-400 text-sm">今天是 <span id="day-count">第 1 天</span></p>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Sleep -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-indigo-500/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-moon text-indigo-400 text-xl"></i>
                    </div>
                    <span class="text-xs text-gray-400">目标: 7-8h</span>
                </div>
                <h3 class="text-gray-400 text-sm">睡眠时长</h3>
                <p class="text-3xl font-bold mt-1" id="sleep-value">--</p>
                <div class="mt-3 h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-indigo-500 rounded-full" id="sleep-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Exercise -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-running text-green-400 text-xl"></i>
                    </div>
                    <span class="text-xs text-gray-400">目标: ≥30min</span>
                </div>
                <h3 class="text-gray-400 text-sm">运动时长</h3>
                <p class="text-3xl font-bold mt-1" id="exercise-value">--</p>
                <div class="mt-3 h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 rounded-full" id="exercise-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Deep Thinking -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-brain text-purple-400 text-xl"></i>
                    </div>
                    <span class="text-xs text-gray-400">目标: ≥500字</span>
                </div>
                <h3 class="text-gray-400 text-sm">深度思考</h3>
                <p class="text-3xl font-bold mt-1" id="thinking-value">--</p>
                <div class="mt-3 h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 rounded-full" id="thinking-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Mood -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-yellow-500/20 rounded-lg flex items-center justify-center">
                        <i class="fas fa-smile text-yellow-400 text-xl"></i>
                    </div>
                    <span class="text-xs text-gray-400">今日情绪</span>
                </div>
                <h3 class="text-gray-400 text-sm">情绪状态</h3>
                <p class="text-3xl font-bold mt-1" id="mood-value">--</p>
                <div class="mt-3 flex space-x-1">
                    <div class="h-2 flex-1 bg-yellow-500 rounded-full" id="mood-bar-1"></div>
                    <div class="h-2 flex-1 bg-gray-700 rounded-full" id="mood-bar-2"></div>
                    <div class="h-2 flex-1 bg-gray-700 rounded-full" id="mood-bar-3"></div>
                </div>
            </div>
        </div>

        <!-- Principles Check -->
        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700 mb-8">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-check-circle text-blue-400 mr-2"></i>
                今日原则检查
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-700/50 rounded-lg p-4 flex items-center space-x-4" id="principle-1">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center">
                        <i class="fas fa-rocket text-gray-400"></i>
                    </div>
                    <div>
                        <h4 class="font-medium">想法应用化</h4>
                        <p class="text-sm text-gray-400">今天有想法变成应用吗？</p>
                    </div>
                </div>
                <div class="bg-gray-700/50 rounded-lg p-4 flex items-center space-x-4" id="principle-2">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center">
                        <i class="fas fa-clock text-gray-400"></i>
                    </div>
                    <div>
                        <h4 class="font-medium">余裕管理</h4>
                        <p class="text-sm text-gray-400">今天保留 2h 余裕时间了吗？</p>
                    </div>
                </div>
                <div class="bg-gray-700/50 rounded-lg p-4 flex items-center space-x-4" id="principle-3">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center">
                        <i class="fas fa-share-alt text-gray-400"></i>
                    </div>
                    <div>
                        <h4 class="font-medium">公开输出</h4>
                        <p class="text-sm text-gray-400">本周有公开输出吗？</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Weekly Trend -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <h2 class="text-xl font-bold mb-4">本周趋势</h2>
                <canvas id="weeklyChart"></canvas>
            </div>

            <!-- Monthly Progress -->
            <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
                <h2 class="text-xl font-bold mb-4">月度达成率</h2>
                <canvas id="monthlyChart"></canvas>
            </div>
        </div>

        <!-- Recent Briefings -->
        <div class="bg-gray-800 rounded-xl p-6 border border-gray-700">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <i class="fas fa-file-alt text-blue-400 mr-2"></i>
                最近简报
            </h2>
            <div class="space-y-3" id="briefings-list">
                <p class="text-gray-400">暂无简报数据...</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 border-t border-gray-700 mt-12">
        <div class="max-w-7xl mx-auto px-4 py-6 text-center text-gray-400">
            <p>Built with AI. Tracked with intention.</p>
            <p class="text-sm mt-2">Life Briefing System © 2026</p>
        </div>
    </footer>

    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const now = new Date();
            document.getElementById('current-date').textContent = 
                `${now.getMonth() + 1}月${now.getDate()}日`;

            // Load metrics data
            loadMetrics();
            
            // Initialize charts
            initCharts();
        });

        async function loadMetrics() {
            try {
                const response = await fetch('metrics.json');
                const data = await response.json();
                updateDashboard(data);
            } catch (error) {
                console.log('No metrics data yet, using defaults');
                updateDashboard(getDefaultData());
            }
        }

        function updateDashboard(data) {
            // Update KPI cards
            document.getElementById('sleep-value').textContent = 
                data.today.sleep ? `${data.today.sleep}h` : '--';
            document.getElementById('sleep-bar').style.width = 
                data.today.sleep ? `${(data.today.sleep / 8) * 100}%` : '0%';

            document.getElementById('exercise-value').textContent = 
                data.today.exercise ? `${data.today.exercise}min` : '--';
            document.getElementById('exercise-bar').style.width = 
                data.today.exercise ? `${Math.min((data.today.exercise / 30) * 100, 100)}%` : '0%';

            document.getElementById('thinking-value').textContent = 
                data.today.thinking ? `${data.today.thinking}字` : '--';
            document.getElementById('thinking-bar').style.width = 
                data.today.thinking ? `${Math.min((data.today.thinking / 500) * 100, 100)}%` : '0%';

            document.getElementById('mood-value').textContent = 
                data.today.mood || '--';

            // Update principles
            updatePrinciple('principle-1', data.today.principles?.app);
            updatePrinciple('principle-2', data.today.principles?.margin);
            updatePrinciple('principle-3', data.today.principles?.output);
        }

        function updatePrinciple(id, status) {
            const el = document.getElementById(id);
            const icon = el.querySelector('i');
            if (status) {
                el.classList.add('bg-green-500/20', 'border', 'border-green-500/30');
                icon.classList.remove('text-gray-400');
                icon.classList.add('text-green-400');
                icon.parentElement.classList.remove('bg-gray-600');
                icon.parentElement.classList.add('bg-green-500/30');
            }
        }

        function initCharts() {
            // Weekly trend chart
            const weeklyCtx = document.getElementById('weeklyChart').getContext('2d');
            new Chart(weeklyCtx, {
                type: 'line',
                data: {
                    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
                    datasets: [{
                        label: '睡眠 (h)',
                        data: [7.5, 6.8, 7.2, 0, 0, 0, 0],
                        borderColor: '#6366f1',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: '运动 (min)',
                        data: [30, 0, 20, 0, 0, 0, 0],
                        borderColor: '#22c55e',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: '#9ca3af' }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#374151' },
                            ticks: { color: '#9ca3af' }
                        },
                        x: {
                            grid: { color: '#374151' },
                            ticks: { color: '#9ca3af' }
                        }
                    }
                }
            });

            // Monthly progress chart
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            new Chart(monthlyCtx, {
                type: 'doughnut',
                data: {
                    labels: ['达成', '未达成'],
                    datasets: [{
                        data: [65, 35],
                        backgroundColor: ['#22c55e', '#374151'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af' }
                        }
                    }
                }
            });
        }

        function getDefaultData() {
            return {
                today: {
                    sleep: null,
                    exercise: null,
                    thinking: null,
                    mood: null,
                    principles: {
                        app: false,
                        margin: false,
                        output: false
                    }
                }
            };
        }
    </script>
</body>
</html>
